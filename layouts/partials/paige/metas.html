{{ $page := . }}

{{ $author := slice }}
{{ $authors := partial "paige/func-authors.html" $page }}
{{ $color := $page.Param `paige.site.color` | default `#0d6efd` }}
{{ $description := $page.Description | markdownify | plainify | htmlUnescape }}
{{ $keywords := slice }}

{{ range $authors }}
    {{ $author = $author | append (.Params.name | default .Title | markdownify | plainify | htmlUnescape) }}
{{ end }}

{{ $author = delimit $author ", " }}

{{ with $page.Keywords }}
    {{ $keywords = . }}
{{ end }}

{{ with $page.GetTerms "categories" }}
    {{ range . }}
        {{ $keywords = $keywords | append (.Title | markdownify | plainify | htmlUnescape) }}
    {{ end }}
{{ else }}
    {{ $keywords = $keywords | append $page.Params.categories }}
{{ end }}

{{ with $page.GetTerms "tags" }}
    {{ range . }}
        {{ $keywords = $keywords | append (.Title | markdownify | plainify | htmlUnescape) }}
    {{ end }}
{{ else }}
    {{ $keywords = $keywords | append $page.Params.tags }}
{{ end }}

{{ $keywords = delimit ($keywords | uniq | sort) ", " }}

<meta charset="utf-8">

{{ with $author }}
    <meta content="{{ . }}" name="author">
{{ end }}

{{ with $description }}
    <meta content="{{ . }}" name="description">
{{ end }}

{{ with $keywords }}
    <meta content="{{ . }}" name="keywords">
{{ end }}

<meta content="{{ $color }}" name="msapplication-TileColor">

{{ if fileExists "assets/browserconfig.xml" }}
    <meta content="{{ (resources.Get `browserconfig.xml` | resources.ExecuteAsTemplate `browserconfig.xml` .).RelPermalink }}" name="msapplication-config">
{{ end }}

<meta content="https://github.com/willfaught/paige" name="theme">
<meta content="{{ $color }}" name="theme-color">
<meta content="width=device-width, initial-scale=1" name="viewport">

{{ template "_internal/opengraph.html" $page }}
{{ template "_internal/twitter_cards.html" $page }}
