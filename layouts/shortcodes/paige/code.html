{{ $caption := .Get "caption" }}
{{ $captionclass := .Get "captionclass" }}
{{ $captionstyle := .Get "captionstyle" }}
{{ $class := .Get "class" }}
{{ $contentclass := .Get "contentclass" | default "mb-2" }}
{{ $contentstyle := .Get "contentstyle" }}
{{ $style := .Get "style" }}

{{ $lang := .Get 0 | default (.Get "lang") | default "plaintext" }}
{{ $options := .Get "options" }}

{{ if $caption }}
    {{ $contentclass = $contentclass | default "mb-2" }}
{{ end }}

{{ $content := highlight (.Inner | replaceRE "^\n" "") $lang $options }}

{{ partial "paige/figure.html" (dict
    "caption" $caption
    "captionclass" $captionclass
    "captionstyle" $captionstyle
    "class" $class
    "content" $content
    "contentclass" $contentclass
    "contentstyle" $contentstyle
    "style" $style
) }}
